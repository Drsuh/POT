      subroutine prime(p,n)

! ----------------------------------------------------------------------

      REAL A(20000),P(2000)
      INTEGER W

! ----------------------------------------------------------------------

      M = (N-1)/2
      DO J=1,N
        A(J) = J
      END DO
      DO K=2,M
        DO L=2*K,N,K
          A(L) = 0
        END DO
      END DO

      II = 1
      P(II) = A(2)
      DO W=3,N,2
        IF(A(W).NE.0) THEN
          II = II + 1
          P(II) = A(W)
        END IF
      END DO

! ----------------------------------------------------------------------
      RETURN
      END
